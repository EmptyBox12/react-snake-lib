import e,{useState as t,useEffect as a}from"react";!function(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===a&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".snakeBoard{align-items:center;display:flex;flex-direction:column;height:500px;justify-content:center;width:500px}.snakeBoardRow{display:flex;height:100%;width:100%}.snakeBoardCell{display:inline-block;flex-grow:1}.snakeBoardShaking{animation:shake .5s}@keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0deg)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0deg)}to{transform:translate(1px,-2px) rotate(-1deg)}}");const r=({map:r,setMap:o,length:n,snake:s,apple:l,shake:d,width:p,height:x,bgColor:i,borderColor:y,innerBorderColor:h,snakeColor:u,snakeHeadColor:f,appleColor:k,borderRadius:m,direction:c,snakeHeadRadius:g,createMap:b,borderWidth:w,boxShadow:C,start:B,startGame:S,startGameText:v,startButtonStyle:R,startButtonHoverStyle:$,shakeBoard:T})=>{const[E,G]=t(!1);return a((()=>{b(n)}),[n]),a((()=>{B&&G(!1)}),[B]),a((()=>{if(s&&s.length>0&&r&&r.length>0){let e=[];r.map(((t,a)=>{let r=[];t.map(((e,t)=>{r.push({snake:s.some((e=>e.x===t&&e.y===a)),apple:l.x===t&&l.y===a,x:t,y:a,head:t===s[s.length-1].x&&a===s[s.length-1].y,tail:t===s[0].x&&a===s[0].y})})),e.push(r)})),o(e)}}),[s,l]),e.createElement("div",{className:d&&T?"snakeBoard snakeBoardShaking":"snakeBoard",style:{width:p,height:x,boxShadow:C,borderRadius:`${m}px`,backgroundColor:B?"white":i}},B&&r.map(((t,a)=>e.createElement("div",{key:a,className:"snakeBoardRow"},t.map(((t,a)=>e.createElement("span",{key:a,className:"snakeBoardCell",style:{backgroundColor:t.head?f:t.snake?u:t.apple?k:i,borderLeftWidth:0===t.x?`${w}px`:"1px",borderRightWidth:t.x===n-1?`${w}px`:"1px",borderTopWidth:0===t.y?`${w}px`:"1px",borderBottomWidth:t.y===n-1?`${w}px`:"1px",borderStyle:"solid",borderTopLeftRadius:!t.head||"up"!==c&&"left"!==c?0===t.x&&0===t.y?`${m}px`:"0px":`${g}px`,borderBottomLeftRadius:!t.head||"down"!==c&&"left"!==c&&null!==c?0===t.x&&t.y===n-1?`${m}px`:"0px":`${g}px`,borderTopRightRadius:!t.head||"up"!==c&&"right"!==c?t.x===n-1&&0===t.y?`${m}px`:"0px":`${g}px`,borderBottomRightRadius:!t.head||"down"!==c&&"right"!==c&&null!==c?t.x===n-1&&t.y===n-1?`${m}px`:"0px":`${g}px`,borderTopColor:t.head?f:t.snake?u:t.apple?k:0===t.y?y:h,borderLeftColor:t.head?f:t.snake?u:t.apple?k:0===t.x?y:h,borderRightColor:t.head?f:t.snake?u:t.apple?k:t.x===n-1?y:h,borderBottomColor:t.head?f:t.snake?u:t.apple?k:t.y===n-1?y:h}})))))),!B&&e.createElement("div",{onMouseEnter:()=>G(!0),onMouseLeave:()=>G(!1),style:E?{...R,...$}:R,onClick:()=>S()},v))},o=o=>{const[n,s]=t([{x:0,y:0},{x:0,y:1},{x:0,y:2}]),[l,d]=t([]),[p,x]=t({}),[i,y]=t(null),[h,u]=t(""),[f,k]=t(!1),[m,c]=t(!1),[g,b]=t(0),[w,C]=t(!1),[B,S]=t(!1),v=o.width??"500px",R=o.height??"500px",$=o.bgColor??"white",T=o.borderColor??"black",E=o.innerBorderColor??"white",G=o.size??16,M=o.snakeColor??"#3e3e3e",H=o.snakeHeadColor??"#1a1a1a",W=o.snakeSpeed??100,L=o.appleColor??"tomato",A=o.borderRadius??5,N=o.snakeHeadRadius??1,K=o.borderWidth??0,I=o.shakeBoard??!0,O=o.boxShadow??"rgba(100, 100, 111, 0.2) 0px 7px 29px 0px",D=o.noWall??!1,j=o.startButtonStyle??{borderRadius:"5px",border:"1px solid silver",cursor:"pointer",padding:"3px",backgroundColor:"white"},z=o.startButtonHoverStyle??{backgroundColor:"#f4f1f1"},U=o.startGameText??"Start Game";function q(e){if(m)if("KeyS"===e.code||"ArrowDown"==e.key){if("up"===i)return;y("down")}else if("KeyW"===e.code||"ArrowUp"==e.key){if("down"===i)return;y("up")}else if("KeyA"===e.code||"ArrowLeft"==e.key){if("right"===i)return;y("left")}else if("KeyD"===e.code||"ArrowRight"==e.key){if("left"===i)return;y("right")}}function F(e){return clearInterval(h),c(!1),C(!0),S(!0),setTimeout((()=>{C(!1)}),200),o.onGameOver&&o.onGameOver(),{x:e.x,y:e.y}}function J(e){let t=[];for(let a=0;a<e;a++){let r=[];for(let t=0;t<e;t++)0===t&&0===a||0===t&&1===a||0===t&&2===a?r.push({snake:!0,apple:!1,x:t,y:a,head:2===a}):r.push({snake:!1,apple:!1,x:t,y:a});t.push(r)}return d(t),t}function P(e){let t=!1;for(;;){if((e??l).map((e=>{e.some((e=>!e.apple&&!e.snake))&&(t=!0)})),!t)break;let a=Math.floor(Math.random()*G),r=Math.floor(Math.random()*G);if(!Q(a,r,e).snake&&!Q(a,r,e).apple){x({x:a,y:r});break}}}function Q(e,t,a){return!(e===G||t===G||e<0||t<0)&&(a?a[t][e]:l[t][e])}return a((()=>{o.onScoreChange&&o.onScoreChange(g)}),[g]),a((()=>(window.document.addEventListener("keydown",q),()=>{window.document.removeEventListener("keydown",q)})),[i,m]),a((()=>{if(clearInterval(h),i&&m){k((e=>!e));let e=setInterval((()=>{k((e=>!e))}),W);u(e)}}),[i]),a((()=>{let e=!1,t=!1;if(!m)return;let a=n.map(((a,r)=>{if(r===n.length-1){if("down"===i){if(a.y+1===G&&!D)return t=!0,F(a);let r=Q(a.x,a.y+1);return r.snake?(t=!0,F(a)):(r.apple&&(e=!0),D&&a.y+1===G?{y:0,x:a.x}:{y:a.y+1,x:a.x})}if("right"===i){if(a.x+1===G&&!D)return t=!0,F(a);let r=Q(a.x+1,a.y);return r.snake?(t=!0,F(a)):(r.apple&&(e=!0),D&&a.x+1===G?{y:a.y,x:0}:{y:a.y,x:a.x+1})}if("up"===i){if(a.y-1==-1&&!D)return t=!0,F(a);let r=Q(a.x,a.y-1);return r.snake?(t=!0,F(a)):(r.apple&&(e=!0),D&&a.y-1==-1?{y:G-1,x:a.x}:{y:a.y-1,x:a.x})}if("left"===i){if(a.x-1==-1&&!D)return t=!0,F(a);let r=Q(a.x-1,a.y);return r.snake?(t=!0,F(a)):(r.apple&&(e=!0),D&&a.x-1==-1?{y:a.y,x:G-1}:{y:a.y,x:a.x-1})}}else if(!(r+1>n.length))return{y:n[r+1].y,x:n[r+1].x}}));if(e){b((e=>e+1));let e="up",t=a[0].x,r=a[0].y;if(a.length>1){let o=a[1].x,n=a[1].y;e=o-t>0?"right":o-t<0?"left":n-r>0?"down":"up"}else e=i;switch(e){case"down":r-1>-1&&!Q(n[0].x,n[0].y-1).snake&&!Q(n[0].x,n[0].y-1).apple?a.unshift({x:t,y:r-1}):t-1>-1&&!Q(n[0].x-1,n[0].y).snake&&!Q(n[0].x-1,n[0].y).apple?a.unshift({x:t-1,y:r}):a.unshift({x:t+1,y:r});break;case"up":r+1<G&&!Q(n[0].x,n[0].y+1).snake&&!Q(n[0].x,n[0].y+1).apple?a.unshift({x:t,y:r+1}):t-1>-1&&!Q(n[0].x-1,n[0].y).snake&&!Q(n[0].x-1,n[0].y).apple?a.unshift({x:t-1,y:r}):a.unshift({x:t+1,y:r});break;case"left":t+1<G&&!Q(n[0].x+1,n[0].y).snake&&!Q(n[0].x+1,n[0].y).apple?a.unshift({x:t+1,y:r}):r-1>-1&&!Q(n[0].x,n[0].y-1).snake&&!Q(n[0].x,n[0].y-1).apple?a.unshift({x:t,y:r-1}):a.unshift({x:t,y:r+1});break;case"right":t-1>-1&&!Q(n[0].x-1,n[0].y).snake&&!Q(n[0].x-1,n[0].y).apple?a.unshift({x:t-1,y:r}):r-1>-1&&!Q(n[0].x,n[0].y-1).snake&&!Q(n[0].x,n[0].y-1).apple?a.unshift({x:t,y:r-1}):a.unshift({x:t,y:r+1})}}t||(s(a),e&&P())}),[f]),e.createElement(r,{map:l,setMap:d,length:G,snake:n,apple:p,shake:w,width:v,height:R,bgColor:$,borderColor:T,innerBorderColor:E,snakeColor:M,snakeHeadColor:H,appleColor:L,borderRadius:A,createMap:J,direction:i,snakeHeadRadius:N,borderWidth:K,boxShadow:O,startGame:function(){c(!0),S(!1);let e=J(G);b(0),s([{x:0,y:0},{x:0,y:1},{x:0,y:2}]),y(null),P(e),o.onGameStart&&o.onGameStart()},gameOver:B,start:m,startButtonStyle:j,startButtonHoverStyle:z,startGameText:U,shakeBoard:I})};export{o as Snake};
