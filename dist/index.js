"use strict";var e=require("react");!function(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===a&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".snakeBoard{align-items:center;display:flex;flex-direction:column;height:500px;justify-content:center;width:500px}.snakeBoardRow{display:flex;height:100%;width:100%}.snakeBoardCell{display:inline-block;flex-grow:1}.snakeBoardShaking{animation:shake .5s}@keyframes shake{0%{transform:translate(1px,1px) rotate(0deg)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0deg)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0deg)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0deg)}to{transform:translate(1px,-2px) rotate(-1deg)}}");const t=({map:t,setMap:a,length:r,snake:o,apple:n,shake:s,width:l,height:d,bgColor:p,borderColor:x,innerBorderColor:i,snakeColor:y,snakeHeadColor:u,appleColor:h,borderRadius:f,direction:k,snakeHeadRadius:c,createMap:m,borderWidth:g,boxShadow:b,start:w,startGame:C,startGameText:S,startButtonStyle:B,startButtonHoverStyle:v,shakeBoard:R})=>{const[E,$]=e.useState(!1);return e.useEffect((()=>{m(r)}),[r]),e.useEffect((()=>{w&&$(!1)}),[w]),e.useEffect((()=>{if(o&&o.length>0&&t&&t.length>0){let e=[];t.map(((t,a)=>{let r=[];t.map(((e,t)=>{r.push({snake:o.some((e=>e.x===t&&e.y===a)),apple:n.x===t&&n.y===a,x:t,y:a,head:t===o[o.length-1].x&&a===o[o.length-1].y,tail:t===o[0].x&&a===o[0].y})})),e.push(r)})),a(e)}}),[o,n]),e.createElement("div",{className:s&&R?"snakeBoard snakeBoardShaking":"snakeBoard",style:{width:l,height:d,boxShadow:b,borderRadius:`${f}px`,backgroundColor:w?"white":p}},w&&t.map(((t,a)=>e.createElement("div",{key:a,className:"snakeBoardRow"},t.map(((t,a)=>e.createElement("span",{key:a,className:"snakeBoardCell",style:{backgroundColor:t.head?u:t.snake?y:t.apple?h:p,borderLeftWidth:0===t.x?`${g}px`:"1px",borderRightWidth:t.x===r-1?`${g}px`:"1px",borderTopWidth:0===t.y?`${g}px`:"1px",borderBottomWidth:t.y===r-1?`${g}px`:"1px",borderStyle:"solid",borderTopLeftRadius:!t.head||"up"!==k&&"left"!==k?0===t.x&&0===t.y?`${f}px`:"0px":`${c}px`,borderBottomLeftRadius:!t.head||"down"!==k&&"left"!==k&&null!==k?0===t.x&&t.y===r-1?`${f}px`:"0px":`${c}px`,borderTopRightRadius:!t.head||"up"!==k&&"right"!==k?t.x===r-1&&0===t.y?`${f}px`:"0px":`${c}px`,borderBottomRightRadius:!t.head||"down"!==k&&"right"!==k&&null!==k?t.x===r-1&&t.y===r-1?`${f}px`:"0px":`${c}px`,borderTopColor:t.head?u:t.snake?y:t.apple?h:0===t.y?x:i,borderLeftColor:t.head?u:t.snake?y:t.apple?h:0===t.x?x:i,borderRightColor:t.head?u:t.snake?y:t.apple?h:t.x===r-1?x:i,borderBottomColor:t.head?u:t.snake?y:t.apple?h:t.y===r-1?x:i}})))))),!w&&e.createElement("div",{onMouseEnter:()=>$(!0),onMouseLeave:()=>$(!1),style:E?{...B,...v}:B,onClick:()=>C()},S))};exports.Snake=a=>{const[r,o]=e.useState([{x:0,y:0},{x:0,y:1},{x:0,y:2}]),[n,s]=e.useState([]),[l,d]=e.useState({}),[p,x]=e.useState(null),[i,y]=e.useState(""),[u,h]=e.useState(!1),[f,k]=e.useState(!1),[c,m]=e.useState(0),[g,b]=e.useState(!1),[w,C]=e.useState(!1),S=a.width??"500px",B=a.height??"500px",v=a.bgColor??"white",R=a.borderColor??"black",E=a.innerBorderColor??"white",$=a.size??16,T=a.snakeColor??"#3e3e3e",G=a.snakeHeadColor??"#1a1a1a",M=a.snakeSpeed??100,H=a.appleColor??"tomato",W=a.borderRadius??5,L=a.snakeHeadRadius??1,A=a.borderWidth??0,N=a.shakeBoard??!0,K=a.boxShadow??"rgba(100, 100, 111, 0.2) 0px 7px 29px 0px",I=a.noWall??!1,O=a.startButtonStyle??{borderRadius:"5px",border:"1px solid silver",cursor:"pointer",padding:"3px",backgroundColor:"white"},D=a.startButtonHoverStyle??{backgroundColor:"#f4f1f1"},j=a.startGameText??"Start Game";function q(e){if(f)if("KeyS"===e.code||"ArrowDown"==e.key){if("up"===p)return;x("down")}else if("KeyW"===e.code||"ArrowUp"==e.key){if("down"===p)return;x("up")}else if("KeyA"===e.code||"ArrowLeft"==e.key){if("right"===p)return;x("left")}else if("KeyD"===e.code||"ArrowRight"==e.key){if("left"===p)return;x("right")}}function z(e){return clearInterval(i),k(!1),b(!0),C(!0),setTimeout((()=>{b(!1)}),200),a.onGameOver&&a.onGameOver(),{x:e.x,y:e.y}}function U(e){let t=[];for(let a=0;a<e;a++){let r=[];for(let t=0;t<e;t++)0===t&&0===a||0===t&&1===a||0===t&&2===a?r.push({snake:!0,apple:!1,x:t,y:a,head:2===a}):r.push({snake:!1,apple:!1,x:t,y:a});t.push(r)}return s(t),t}function F(e){let t=!1;for(;;){if((e??n).map((e=>{e.some((e=>!e.apple&&!e.snake))&&(t=!0)})),!t)break;let a=Math.floor(Math.random()*$),r=Math.floor(Math.random()*$);if(!J(a,r,e).snake&&!J(a,r,e).apple){d({x:a,y:r});break}}}function J(e,t,a){return!(e===$||t===$||e<0||t<0)&&(a?a[t][e]:n[t][e])}return e.useEffect((()=>{a.onScoreChange&&a.onScoreChange(c)}),[c]),e.useEffect((()=>(window.document.addEventListener("keydown",q),()=>{window.document.removeEventListener("keydown",q)})),[p,f]),e.useEffect((()=>{if(clearInterval(i),p&&f){h((e=>!e));let e=setInterval((()=>{h((e=>!e))}),M);y(e)}}),[p]),e.useEffect((()=>{let e=!1,t=!1;if(!f)return;let a=r.map(((a,o)=>{if(o===r.length-1){if("down"===p){if(a.y+1===$&&!I)return t=!0,z(a);let r;return r=I&&a.y+1===$?J(a.x,0):J(a.x,a.y+1),r.snake?(t=!0,z(a)):(r.apple&&(e=!0),I&&a.y+1===$?{y:0,x:a.x}:{y:a.y+1,x:a.x})}if("right"===p){if(a.x+1===$&&!I)return t=!0,z(a);let r;return r=I&&a.x+1===$?J(0,a.y):J(a.x+1,a.y),r.snake?(t=!0,z(a)):(r.apple&&(e=!0),I&&a.x+1===$?{y:a.y,x:0}:{y:a.y,x:a.x+1})}if("up"===p){if(a.y-1==-1&&!I)return t=!0,z(a);let r;return r=I&&a.y-1==-1?J(a.x,$-1):J(a.x,a.y-1),r.snake?(t=!0,z(a)):(r.apple&&(e=!0),I&&a.y-1==-1?{y:$-1,x:a.x}:{y:a.y-1,x:a.x})}if("left"===p){if(a.x-1==-1&&!I)return t=!0,z(a);let r;return r=I&&a.x-1==-1?J($-1,a.y):J(a.x-1,a.y),r.snake?(t=!0,z(a)):(r.apple&&(e=!0),I&&a.x-1==-1?{y:a.y,x:$-1}:{y:a.y,x:a.x-1})}}else if(!(o+1>r.length))return{y:r[o+1].y,x:r[o+1].x}}));if(e){m((e=>e+1));let e="up",t=a[0].x,o=a[0].y;if(a.length>1){let r=a[1].x,n=a[1].y;e=r-t>0?"right":r-t<0?"left":n-o>0?"down":"up"}else e=p;switch(e){case"down":o-1>-1&&!J(r[0].x,r[0].y-1).snake&&!J(r[0].x,r[0].y-1).apple?a.unshift({x:t,y:o-1}):t-1>-1&&!J(r[0].x-1,r[0].y).snake&&!J(r[0].x-1,r[0].y).apple?a.unshift({x:t-1,y:o}):a.unshift({x:t+1,y:o});break;case"up":o+1<$&&!J(r[0].x,r[0].y+1).snake&&!J(r[0].x,r[0].y+1).apple?a.unshift({x:t,y:o+1}):t-1>-1&&!J(r[0].x-1,r[0].y).snake&&!J(r[0].x-1,r[0].y).apple?a.unshift({x:t-1,y:o}):a.unshift({x:t+1,y:o});break;case"left":t+1<$&&!J(r[0].x+1,r[0].y).snake&&!J(r[0].x+1,r[0].y).apple?a.unshift({x:t+1,y:o}):o-1>-1&&!J(r[0].x,r[0].y-1).snake&&!J(r[0].x,r[0].y-1).apple?a.unshift({x:t,y:o-1}):a.unshift({x:t,y:o+1});break;case"right":t-1>-1&&!J(r[0].x-1,r[0].y).snake&&!J(r[0].x-1,r[0].y).apple?a.unshift({x:t-1,y:o}):o-1>-1&&!J(r[0].x,r[0].y-1).snake&&!J(r[0].x,r[0].y-1).apple?a.unshift({x:t,y:o-1}):a.unshift({x:t,y:o+1})}}t||(o(a),e&&F())}),[u]),e.createElement(t,{map:n,setMap:s,length:$,snake:r,apple:l,shake:g,width:S,height:B,bgColor:v,borderColor:R,innerBorderColor:E,snakeColor:T,snakeHeadColor:G,appleColor:H,borderRadius:W,createMap:U,direction:p,snakeHeadRadius:L,borderWidth:A,boxShadow:K,startGame:function(){k(!0),C(!1);let e=U($);m(0),o([{x:0,y:0},{x:0,y:1},{x:0,y:2}]),x(null),F(e),a.onGameStart&&a.onGameStart()},gameOver:w,start:f,startButtonStyle:O,startButtonHoverStyle:D,startGameText:j,shakeBoard:N})};
